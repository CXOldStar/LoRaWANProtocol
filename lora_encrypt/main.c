
#include <stdio.h>
#include <stdint.h>
#include "LoRaMacCrypto.h"


static uint8_t AppSKey[] = { 
    0x2B, 0x7E, 0x15, 0x16, 0x28, 0xAE, 0xD2, 0xA6,
    0xAB, 0xF7, 0x15, 0x88, 0x09, 0xCF, 0x4F, 0x3C
};


// uint8_t chFakeData[64];
uint8_t chEncData[50] = {0x5b, 0x48, 0x13, 0x68, 0xa8, 0xf6, 0x9b, 0xc0, 0xdf,
						 0x35, 0xb5, 0x7e, 0x5a, 0x27, 0x75, 0xbb, 0x74, 0x6b,
						 0xe1, 0x81, 0x27, 0x4e, 0xf2, 0x69, 0x47, 0xc3, 0x40,
						 0x0f, 0xb9, 0xbe, 0xb5, 0x03, 0x26, 0xe4, 0xb3, 0xeb,
						 0x58, 0x62, 0x7d, 0xf9, 0xa7, 0x51, 0x87, 0xa5, 0xd7,
						 0x4d, 0x17, 0xc8, 0xb9, 0x2e};
uint8_t chDecData[50];

int main(void) {
	uint8_t i;
	
    /*		
	for (i = 0; i < 64; i++) {
		chFakeData[i] = i;
	}
     
	printf("Before encryption:\n");
	for (i = 0; i < 64; i++) {
		printf("%x ", chFakeData[i]);
	}
	putchar('\n');
	
	LoRaMacPayloadEncrypt(chFakeData, 64, AppSKey, 0x12345678, 1, 0x00000010, chEncData);
	*/
	printf("After encryption:\n");
	for (i = 0; i < 50; i++) {
		printf("%x ", chEncData[i]);
	}
	putchar('\n');

	LoRaMacPayloadDecrypt(chEncData, 50, AppSKey, 0x6d609574, 0, 0x00000001, chDecData);

	printf("After decryption:\n");
	for (i = 0; i < 50; i++) {
		printf("%x ", chDecData[i]);
	}
	putchar('\n');
	
	return 0;
}
